<h1>Displaying Record for Inventory Item #<%=@equipment.id%></h1>

<p id="notice"><%= notice %></p>

<%=render :partial => "qr_code"%>

<table border=1>
  <thead>
    <tr>
      <h5>Item Information</h5>
    </tr>
    <tr>
      <th>Type</th>
      <th>Description</th>
      <th>Serial Number</th>
      <th>Status</th>
      <th>Location</th>
      <th>Department</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><%=@equipment.type%></td>
      <td><%=@equipment.description%></td>
      <td><%=@equipment.serial%></td>
      <td><%=@equipment.statusAlias%></td>
      <td><%=Location.find(@equipment.locationID).name%></td>
      <td><%=Department.find(@equipment.departmentID).name%></td>
    </tr>
  </tbody>
</table>

<%if @equipment.type == "Computer"%>

    <table border=1>
      <thead>
        <tr>
          <h5>Installed Programs</h5>
        </tr>
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th>Serial</th>
          <th>License</th>
        </tr>
      </thead>
      <tbody>
        <% ProgramAssociation.all.each do |program| %>
          <% if program.equipmentID==@equipment.id then %>
            <tr class="spriteButton" onclick="document.location='<%=program_path(Program.find(program.programID).id)%>'" style="cursor:pointer">
              <td><%=Program.find(program.programID).name%></td>
              <td><%=Program.find(program.programID).description%></td>
              <td><%=Program.find(program.programID).serial%></td>
              <td><%=Program.find(program.programID).license%></td>
            </tr>
          <%end%>
        <%end%>
        <tr><%= link_to 'Add A Program', program_association_path(@equipment.id), method: :post %></tr>
      </tbody>
    </table>


    <table border=1>
      <thead>
        <tr>
          <h5>Connected Printers</h5>
        </tr>
        <tr>
          <th>Description</th>
          <th>IP Address</th>
          <th>Location</th>
        </tr>
      </thead>

      <tbody>
        <% PrinterAssociation.all.each do |printer| %>
          <% if printer.equipmentID==@equipment.id then %>
            <tr class="spriteButton" onclick="document.location='<%=equipment_path(Printer.find(printer.printerID).id)%>'" style="cursor:pointer">
              <td><%=Printer.find(printer.printerID).description%></td>
              <td><%=Printer.find(printer.printerID).ip%></td>
              <td><%=Location.find(Printer.find(printer.printerID).locationID).name%></td>
            </tr>
          <%end%>
        <%end%>
        <tr><%= link_to 'Add A Printer', printer_association_path(@equipment.id), method: :post %></tr>
      </tbody>
    </table>

<%end%>

<%if @tickets.count !=0%>
  <table border=1>
    <thead>
      <tr>
        <h5>Ticket History</h5>
      </tr>
      <tr>
        <th>Ticket ID</th>
        <th>Date Created</th>
        <th>Status</th>
        <th>Technician</th>
        <th>Client</th>
        <th>Problem</th>
        <th>Resolution</th>
      </tr>
    </thead>

    <tbody>
    <% @tickets.each do |t| %>
      <% if t.status==0 then %>
        <tr bgcolor="#C0C0C0" class="spriteButton" onclick="document.location='<%=ticket_path(t.id)%>'" style="cursor:pointer">
      <% elsif t.urgency.between?(1,2) then %>
        <tr bgcolor="#00FF00" class="spriteButton" onclick="document.location='<%=ticket_path(t.id)%>'" style="cursor:pointer">
      <% elsif t.urgency.between?(3,4) then %>
        <tr bgcolor="#FFFF00" class="spriteButton" onclick="document.location='<%=ticket_path(t.id)%>'" style="cursor:pointer">
      <% elsif t.urgency == 5 then%>
        <tr bgcolor="#FF0000" class="spriteButton" onclick="document.location='<%=ticket_path(t.id)%>'" style="cursor:pointer">
      <% elsif t.urgency==0 then%>
        <tr bgcolor="#6D6D70" class="spriteButton" onclick="document.location='<%=ticket_path(t.id)%>'" style="cursor:pointer">
      <% else %>
        <tr class="spriteButton" onclick="document.location='<%=ticket_path(t.id)%>'" style="cursor:pointer">
      <%end%>
      
          <td><%=t.id%></td>
          <td><%=t.created_at%></td>
          <td><%=t.status%></td>
          <td><%=t.assignedTech%></td>
          <td><%=t.clientID%></td>
          <td><%=t.problemDescription%></td>
          <td><%=t.resolution%></td>
        </tr>
   
    <%end%>

        <tr><%= link_to 'Add A Ticket', "/tickets/new/#{@equipment.id}", method: :post %></tr>
      </tbody>
    </table>
<%end%>

<%= link_to 'Edit', edit_equipment_path(@equipment) %> |
<%= link_to 'Back', equipment_index_path %>
